import{a1 as z,r as f,bL as O,bf as R,bM as V,bN as g,bO as w,bP as B,b8 as T,u as M,bC as k,j as E,B as I,bs as P,bQ as W,R as x}from"./main.js";import{u as L}from"./useTools.js";const A=({tool:s,mode:r,id:l,current:e,edit:a,errorData:b,initializeFn:p,validationFields:o})=>{const i=z(),[h,n]=f.useState(0),[j,u]=f.useState(!1),[c,y]=f.useState(!1);return f.useEffect(()=>{const t=O(b);n(t),e&&(t===0&&!e.isValid?R({tool:s,keypath:"isValid",updates:!0,id:l}):t>0&&e.isValid&&R({tool:s,keypath:"isValid",updates:!1,id:l}))},[b,s]),f.useEffect(()=>{if(e===void 0){const d={...p(),id:l};i(V({tool:s,data:d}))}},[e,i]),f.useEffect(()=>{if(a===void 0&&e){i(g({id:l,tool:s}));const t=w(e);i(B({tool:s,validationObject:t,id:l}))}},[s,i,a,e]),f.useEffect(()=>{if(r==="preview"){if(e&&o.length>0){if(!o.every(d=>e[d]!==void 0))return;i(T({tool:s,fields:o,refObj:a,id:e.id}))}}else if(r==="edit"&&a&&o.length>0&&!c){if(!o.every(d=>a[d]!==void 0))return;y(!0),i(T({tool:s,fields:o,refObj:a,id:a.id}))}},[i,r,a,e]),{errorCount:h,setErrorCount:n}},D=["event","apt","storyThread"],q=({tab:s,initializeTool:r,validationFields:l,editComponent:e,previewComponent:a,checklistContent:b,editComponentProps:p={},previewComponentProps:o={}})=>{const{showModal:i,closeModal:h}=M(),{tool:n,side:j,id:u,mode:c,tabId:y}=s,{current:t,edit:d,errors:m}=L(n,u);A({tool:n,mode:s.mode,id:u,edit:d,current:t,errorData:m,initializeFn:()=>r(n),validationFields:l});const{splitSize:C,soloSize:v,splitTabs:S}=k();if(!t)return E.jsx(I,{children:"Loading..."});if(t!==null)return E.jsx(P.Provider,{value:{tool:n,id:u,tabId:y,mode:c,side:j,showModal:i,closeModal:h,tab:s},children:E.jsx(W,{mode:c,variant:D.includes(n)?"fullWidth":S?C?"default":"blend":v?"blend":"default",tabType:"tool",minWidth:300,children:c==="edit"?x.createElement(e,{...p}):x.createElement(a,{...o})})})};export{q as C};
