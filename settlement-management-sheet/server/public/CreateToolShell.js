import{a0 as z,r as f,bj as V,aZ as R,bk as g,bl as O,bm as k,bn as w,aS as T,as as B,b9 as I,j,i as M,a$ as W,bo as P,R as m}from"./main.js";import{u as A}from"./useTools.js";const D=({tool:s,mode:r,id:l,current:e,edit:a,errorData:p,initializeFn:b,validationFields:o})=>{const i=z(),[h,n]=f.useState(0),[E,u]=f.useState(!1),[c,y]=f.useState(!1);return f.useEffect(()=>{const t=V(p);n(t),e&&(t===0&&!e.isValid?R({tool:s,keypath:"isValid",updates:!0,id:l}):t>0&&e.isValid&&R({tool:s,keypath:"isValid",updates:!1,id:l}))},[p,s]),f.useEffect(()=>{if(e===void 0){const d={...b(),id:l};i(g({tool:s,data:d}))}},[e,i]),f.useEffect(()=>{if(a===void 0&&e){i(O({id:l,tool:s}));const t=k(e);i(w({tool:s,validationObject:t,id:l}))}},[s,i,a,e]),f.useEffect(()=>{if(r==="preview"){if(e&&o.length>0){if(!o.every(d=>e[d]!==void 0))return;i(T({tool:s,fields:o,refObj:a,id:e.id}))}}else if(r==="edit"&&a&&o.length>0&&!c){if(!o.every(d=>a[d]!==void 0))return;y(!0),i(T({tool:s,fields:o,refObj:a,id:a.id}))}},[i,r,a,e]),{errorCount:h,setErrorCount:n}},L=["event","apt","storyThread"],q=({tab:s,initializeTool:r,validationFields:l,editComponent:e,previewComponent:a,checklistContent:p,editComponentProps:b={},previewComponentProps:o={}})=>{const{showModal:i,closeModal:h}=B(),{tool:n,side:E,id:u,mode:c,tabId:y}=s,{current:t,edit:d,errors:x}=A(n,u);D({tool:n,mode:s.mode,id:u,edit:d,current:t,errorData:x,initializeFn:()=>r(n),validationFields:l});const{splitSize:S,soloSize:v,splitTabs:C}=I();if(!t)return j.jsx(M,{children:"Loading..."});if(t!==null)return j.jsx(W.Provider,{value:{tool:n,id:u,tabId:y,mode:c,side:E,showModal:i,closeModal:h,tab:s},children:j.jsx(P,{mode:c,variant:L.includes(n)?"fullWidth":C?S?"default":"blend":v?"blend":"default",tabType:"tool",minWidth:300,children:c==="edit"?m.createElement(e,{...b}):m.createElement(a,{...o})})})};export{q as C};
