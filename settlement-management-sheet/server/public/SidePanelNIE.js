import{H as S,j as s,aT as M,ah as v,ap as T,b4 as E,r as i,aR as L,aF as B,B as d,T as c,O as R,a6 as H,b5 as P,ak as f,J as C,Y as F,a as b}from"./main.js";const G=S(s.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),O=S(s.jsx("path",{d:"M19 13H5v-2h14z"}),"Remove");async function V({nodeIds:x}){return M.post("/glossary/entries/",{ids:x}).then(r=>r.data)}const D=()=>{const x=v(T()),r=v(E(x||"")),[k,y]=i.useState(null),[l,g]=i.useState([]),[u,w]=i.useState(""),{openRelay:I}=L({id:"NIEParser",onComplete:e=>{}}),j=i.useMemo(()=>Object.values(r).sort((e,t)=>e.name.localeCompare(t.name)),[r]).find(e=>e.name==="Astagua"),h=i.useMemo(()=>{if(!j)return[];function e(t,n,o=[]){const a=n[t];return a&&a.children&&a.children.forEach(m=>{o.push(n[m.id]),e(m.id,n,o)}),o.sort((m,A)=>m.name.localeCompare(A.name))}return e(j.id,r).filter(t=>!l.includes(t))},[j,r,l]),p=i.useMemo(()=>u?h.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())):h,[u,h]),{getAlphaColor:N}=B(),z=async()=>{const e=await V({nodeIds:l.map(a=>a.id)}),{entries:t,backlinks:n}=e,o=new Worker(new URL("/assets/nie-worker-Cjm5hkfV.js",import.meta.url),{type:"module"});o.onerror=a=>{console.error("Worker error:",a)},o.onmessage=a=>{a.data.action==="complete"&&I({data:a.data,status:"complete"})},o.postMessage({action:"buildGraph",nodes:l,entries:t,backlinks:n})};return s.jsxs(d,{sx:{position:"relative",flex:1},children:[s.jsx(c,{variant:"h6",sx:{p:2},children:"NIE Select List"}),s.jsx(R,{label:"Search Nodes",variant:"outlined",size:"small",sx:{mb:2,width:"95%"},value:u,onChange:e=>w(e.target.value),slotProps:{input:{endAdornment:s.jsx(H,{})}}}),s.jsx(P,{height:300,width:300,itemSize:35,itemCount:p.length,overscanCount:8,children:({index:e,style:t})=>s.jsxs(d,{style:t,sx:{display:"flex",alignItems:"center",gap:2,backgroundColor:k===e?N({color:"success",key:"main",opacity:.4}):e%2===0?"background.paper":"background.default",padding:"4px 8px",justifyContent:"space-between"},onMouseEnter:()=>y(e),onMouseLeave:()=>y(null),children:[f[p[e].entryType]||null,s.jsx(c,{variant:"body2",sx:{width:"50%",textAlign:"start",cursor:"default"},children:p[e].name}),s.jsx(C,{size:"small",color:"primary",onClick:()=>{g(n=>[...n,p[e]])},children:s.jsx(G,{fontSize:"small"})})]})}),s.jsxs(c,{variant:"body2",sx:{p:2},children:["Total Nodes: ",h.length]}),s.jsx(F,{sx:{borderColor:"info.main"}}),s.jsx(b,{variant:"contained",onClick:()=>g([]),sx:{mt:2,width:"90%"},children:"Clear Selected Nodes"}),s.jsxs(d,{children:[s.jsx(c,{variant:"body1",sx:{p:2},children:"Selected Nodes:"}),s.jsx(d,{sx:{maxHeight:300,overflowY:"auto",minHeight:300,border:1,borderColor:"divider"},children:l.map(e=>s.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2},children:[f[e.entryType]||null,s.jsx(c,{variant:"body2",sx:{p:1,borderBottom:1,borderColor:"divider"},children:e.name}),s.jsx(C,{size:"small",color:"secondary",onClick:()=>{g(t=>t.filter(n=>n.id!==e.id))},children:s.jsx(O,{fontSize:"small"})})]},e.id))})]}),s.jsx(b,{variant:"contained",sx:{width:"90%",mt:2},color:"info",onClick:z,children:"Build Maps"})]})};export{D as default};
