import{b as z,k as f,aq as V,D as m,ar as g,as as O,at as k,au as w,v as T,e as B,f as I,j as b,B as M,aa as x}from"./main.js";import{S as P,P as W}from"./PageBox.js";import{u as D}from"./useTabSplit.js";const q=({tool:s,mode:r,id:l,current:e,edit:a,errorData:p,initializeFn:h,validationFields:o})=>{const i=z(),[y,n]=f.useState(0),[j,u]=f.useState(!1),[c,E]=f.useState(!1);return f.useEffect(()=>{const t=V(p);n(t),e&&(t===0&&!e.isValid?m({tool:s,keypath:"isValid",updates:!0,id:l}):t>0&&e.isValid&&m({tool:s,keypath:"isValid",updates:!1,id:l}))},[p,s]),f.useEffect(()=>{if(e===void 0){const d={...h(),id:l};i(g({tool:s,data:d}))}},[e,i]),f.useEffect(()=>{if(a===void 0&&e){i(O({id:l,tool:s}));const t=k(e);i(w({tool:s,validationObject:t,id:l}))}},[s,i,a,e]),f.useEffect(()=>{if(r==="preview"){if(e&&o.length>0){if(!o.every(d=>e[d]!==void 0))return;i(T({tool:s,fields:o,refObj:a,id:e.id}))}}else if(r==="edit"&&a&&o.length>0&&!c){if(!o.every(d=>a[d]!==void 0))return;E(!0),i(T({tool:s,fields:o,refObj:a,id:a.id}))}},[i,r,a,e]),{errorCount:y,setErrorCount:n}},A=["event","apt","storyThread"],J=({tab:s,initializeTool:r,validationFields:l,editComponent:e,previewComponent:a,checklistContent:p,editComponentProps:h={},previewComponentProps:o={}})=>{const{showModal:i,closeModal:y}=B(),{tool:n,side:j,id:u,mode:c,tabId:E}=s,{current:t,edit:d,errors:R}=I(n,u);q({tool:n,mode:s.mode,id:u,edit:d,current:t,errorData:R,initializeFn:()=>r(n),validationFields:l});const{splitSize:v,soloSize:S,splitTabs:C}=D();if(!t)return b.jsx(M,{children:"Loading..."});if(t!==null)return b.jsx(P.Provider,{value:{tool:n,id:u,tabId:E,mode:c,side:j,showModal:i,closeModal:y,tab:s},children:b.jsx(W,{mode:c,variant:A.includes(n)?"fullWidth":C?v?"default":"blend":S?"blend":"default",tabType:"tool",minWidth:300,children:c==="edit"?x.createElement(e,{...h}):x.createElement(a,{...o})})})};export{J as C};
